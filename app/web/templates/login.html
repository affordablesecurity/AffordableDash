{% extends "base.html" %}
{% block content %}
  <div class="card">
    <h1>Sign in</h1>
    {% if error %}<p class="error">{{ error }}</p>{% endif %}
    <form id="loginForm">
      <label>Email</label>
      <input name="email" type="email" required/>
      <label>Password</label>
      <input name="password" type="password" required minlength="8"/>
      <button type="submit">Login</button>
    </form>
    <p class="hint">Starter scaffold. We'll add password reset, roles, and multi-location UI next.</p>
  </div>

  <script>
    const form = document.getElementById("loginForm");
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const fd = new FormData(form);
      const body = Object.fromEntries(fd.entries());
      const res = await fetch("/api/v1/auth/login", {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify(body)
      });
      if (res.ok) window.location.href = "/dashboard";
      else alert("Login failed");
    });
  </script>
{% endblock %}
